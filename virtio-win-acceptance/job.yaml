- job-template:
    description: |
        Managed by Jenkins Job Builder. Do not edit via web.
    name: 'pipeline-{component}-{osversion}-trigger'
    project-type: pipeline
    concurrent: true
    parameters:
        - string:
            name: 'BREW_NVR'
            default: ''
            description: "NVR of the brew build (e.g. {{component}}-{{version}}-{{release}},if trigger virtio-win-prewhql test, can use like virtio-win-prewhql-0.1-142 ;else if trigger virtio-win test, use like virtio-win-1.9.3-1.el7 )"
        - hidden:
            name: OSVERSION
            default: '{osversion}'
            description: 'Major version of the OS'
        - hidden:
            name: COMPONENT
            default: '{component}'
            description: 'Tested component for downstream QEMU'
        - hidden:
            name: CI_MESSAGE
            default: ''
            description: "Used to inject the message's body in case the UMB trigger is enabled"
    triggers:
        - ci-trigger:
            provider-name: "Red Hat UMB"
            override-topic: "Consumer.rh-jenkins-ci-plugin.{uuid}.VirtualTopic.eng.brew.build.tag"
            jms-selector: "type = 'Tag' AND name = '{component}' AND release LIKE '{rel_pattern}'"
    dsl:
        !include-raw-escape: jobs/virtio-win-acceptance/scripts/trigger.groovy


- job-template:
    description: |
        Managed by Jenkins Job Builder. Do not edit via web.
    name: 'pipeline-{component}-{osversion}-{module_stream}-{windows_group}-runtest'
    project-type: pipeline
    concurrent: true
    parameters:
        - string:
            name: 'BREW_NVR'
            default: ''
            description: "NVR of the brew build (e.g. {{component}}-{{version}}-{{release}},if trigger virtio-win-prewhql test, can use like virtio-win-prewhql-0.1-142 ;else if trigger virtio-win test, use like virtio-win-1.9.3-1.el7 )"
        - string:
            name: 'COMPOSE_ID'
            default: ''
            description: "Compose id (e.g. RHEL-8.0-20190106.n.0)'"
        - hidden:
            name: OSVERSION
            default: '{osversion}'
            description: 'Major version of the OS'
        - hidden:
            name: WINDOWS_GROUP
            default: '{windows_group}'
            description: 'Tested windows group for downstream QEMU'
        - hidden:
            name: MODULE_STREAM
            default: '{module_stream}'
            description: 'Module stream for virt module(legacy means virt module is unsupported)'
    dsl:
        !include-raw-escape: jobs/virtio-win-acceptance/scripts/runtest.groovy
