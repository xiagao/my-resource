- job-template:
    description: |
        Managed by Jenkins Job Builder. Do not edit via web.
    name: 'pipeline-{component}-{osversion}-trigger'
    project-type: pipeline
    concurrent: true
    parameters:
        - string:
            name: 'BREW_NVR'
            default: ''
            description: 'NVR of the QEMU build (e.g. qemu-kvm-rhev-{{version}}-{{release}})'
        - string:
            name: 'BREW_TAG'
            default: ''
            description: 'TAG of the QEMU build (e.g. rhevh-rhel-{{x}}.{{y}}-candidate)'
        - string:
            name: 'HARDWARES'
            default: ''
            description: 'Comma separated list of hardware where the test runs on (support x86_64-intel,x86_64-amd,ppc64le-power8,ppc64le-power9)'
        - hidden:
            name: OSVERSION
            default: '{osversion}'
            description: 'Major version of the OS'
        - hidden:
            name: COMPONENT
            default: '{component}'
            description: 'Tested component for downstream QEMU'
        - hidden:
            name: CI_MESSAGE
            default: ''
            description: "Used to inject the message's body in case the UMB trigger is enabled"
    triggers:
        - ci-trigger:
            provider-name: "Red Hat UMB"
            override-topic: "Consumer.rh-jenkins-ci-plugin.kvm-ci-{component}-{osversion}.VirtualTopic.qe.ci.>"
            jms-selector: "CI_TYPE = 'brew-tag' AND name = '{component}' AND tag LIKE '{tag_pattern}' AND release LIKE '{rel_pattern}'"
    dsl:
        !include-raw-escape: jobs/acceptance/scripts/trigger.groovy


- job-template:
    description: |
        Managed by Jenkins Job Builder. Do not edit via web.
    name: 'pipeline-{component}-{osversion}-{hardware}-runtest'
    project-type: pipeline
    concurrent: true
    parameters:
        - string:
            name: BREW_NVR
            default: ''
            description: 'NVR of the QEMU build (e.g. qemu-kvm-rhev-{{version}}-{{release}})'
        - string:
            name: BREW_TAG
            default: ''
            description: 'TAG of the QEMU build (e.g. rhevh-rhel-{{x}}.{{y}}-candidate)'
        - hidden:
            name: HARDWARE
            default: '{hardware}'
            description: 'The supported hardware where the test could run on'
        - hidden:
            name: OSVERSION
            default: '{osversion}'
            description: 'Major version of the OS'
        - hidden:
            name: COMPONENT
            default: '{component}'
            description: 'Tested component for downstream QEMU'
    dsl:
        !include-raw-escape: '{script_path}'
